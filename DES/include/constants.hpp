#ifndef __CONSTANTS_HPP__
#define __CONSTANTS_HPP__

#include <cstdint>

const static uint32_t ROUNDS = 16,                           // Total rounds
                      KEY_LEN = 16,                          // Key length in chars
                      BYTE_BITS = 8,                         // Bits in one byte
                      BLOCK_BITS = 64,                       // Bits in one block
                      PART_BITS = BLOCK_BITS / 2,            // Bits in one block part
                      SUBKEY_BITS = 56,                      // Bits in one subkey
                      SUBKEY_PART_BITS = SUBKEY_BITS / 2,    // Bits in one subkey part
                      BLOCK_BYTES = 8,                       // Bytes in one block
                      SBOX_BITS = 48,                        // Bits in block before sboxing
                      SBOX_PART_BITS = 6;                    // Bits in one part of sbox
                      
const static uint64_t PART_MASK = 0xffffffff00000000,        // Mask for first part of block
                      BYTE_MASK = 0xff,                      // Mask for first byte
                      SUBKEY_PART_MASK = 0xfffffff000000000, // Mask for first part of subkey
                      SBOX_MASK = 0x3f;                      // Mask for one sbox part

const static uint32_t PC1_LEN = SUBKEY_BITS;

const static uint32_t PC1[PC1_LEN] = {
  56, 48, 40, 32, 24, 16, 8,
  0, 57, 49, 41, 33, 25, 17,
  9, 1, 58, 50, 42, 34, 26,
  18, 10, 2, 59, 51, 43, 35,
  62, 54, 46, 38, 30, 22, 14,
  6, 61, 53, 45, 37, 29, 21,
  13, 5, 60, 52, 44, 36, 28,
  20, 12, 4, 27, 19, 11, 3
};

const static uint32_t PC2_LEN = 48;

const static uint32_t PC2[PC2_LEN] = {
  13, 16, 10, 23, 0, 4,
  2, 27, 14, 5, 20, 9,
  22, 18, 11, 3, 25, 7,
  15, 6, 26, 19, 12, 1,
  40, 51, 30, 36, 46, 54,
  29, 39, 50, 44, 32, 47,
  43, 48, 38, 55, 33, 52,
  45, 41, 49, 35, 28, 31
};

const static uint32_t SUBKEYS_SHIFTS[ROUNDS] = {
  1, 1, 2, 2, 2, 2, 2, 2,
  1, 2, 2, 2, 2, 2, 2, 1
};

const static uint64_t MASKS[BLOCK_BITS] = {
  0x8000000000000000, 0x4000000000000000, 0x2000000000000000, 0x1000000000000000,
  0x800000000000000, 0x400000000000000, 0x200000000000000, 0x100000000000000,
  0x80000000000000, 0x40000000000000, 0x20000000000000, 0x10000000000000, 0x8000000000000,
  0x4000000000000, 0x2000000000000, 0x1000000000000, 0x800000000000, 0x400000000000,
  0x200000000000, 0x100000000000, 0x80000000000, 0x40000000000, 0x20000000000, 0x10000000000,
  0x8000000000, 0x4000000000, 0x2000000000, 0x1000000000, 0x800000000, 0x400000000, 0x200000000,
  0x100000000, 0x80000000, 0x40000000, 0x20000000, 0x10000000, 0x8000000, 0x4000000, 0x2000000,
  0x1000000, 0x800000, 0x400000, 0x200000, 0x100000, 0x80000, 0x40000, 0x20000, 0x10000,
  0x8000, 0x4000, 0x2000, 0x1000, 0x800, 0x400, 0x200, 0x100, 0x80, 0x40, 0x20, 0x10, 0x8, 0x4, 0x2, 0x1
};

const static uint32_t IP_LEN = 64;

const static uint32_t IP[IP_LEN] = {
  57, 49, 41, 33, 25, 17, 9, 1,
  59, 51, 43, 35, 27, 19, 11, 3,
  61, 53, 45, 37, 29, 21, 13, 5,
  63, 55, 47, 39, 31, 23, 15, 7,
  56, 48, 40, 32, 24, 16, 8, 0,
  58, 50, 42, 34, 26, 18, 10, 2,
  60, 52, 44, 36, 28, 20, 12, 4,
  62, 54, 46, 38, 30, 22, 14, 6
};

const static uint32_t E_LEN = 48;

const static uint32_t E[E_LEN] = {
  31, 0, 1, 2, 3, 4,
  3, 4, 5, 6, 7, 8,
  7, 8, 9, 10, 11, 12,
  11, 12, 13, 14, 15, 16,
  15, 16, 17, 18, 19, 20,
  19, 20, 21, 22, 23, 24,
  23, 24, 25, 26, 27, 28,
  27, 28, 29, 30, 31, 0
};

const static uint32_t SBOX_LEN = 8, SBOX_SIZE = 64;

const static uint64_t SBOX[SBOX_LEN][SBOX_SIZE] = { {
  0xe000000000000000, 0x0, 0x4000000000000000, 0xf000000000000000, 
  0xd000000000000000, 0x7000000000000000, 0x1000000000000000, 0x4000000000000000, 
  0x2000000000000000, 0xe000000000000000, 0xf000000000000000, 0x2000000000000000, 
  0xb000000000000000, 0xd000000000000000, 0x8000000000000000, 0x1000000000000000, 
  0x3000000000000000, 0xa000000000000000, 0xa000000000000000, 0x6000000000000000, 
  0x6000000000000000, 0xc000000000000000, 0xc000000000000000, 0xb000000000000000, 
  0x5000000000000000, 0x9000000000000000, 0x9000000000000000, 0x5000000000000000, 
  0x0, 0x3000000000000000, 0x7000000000000000, 0x8000000000000000, 
  0x4000000000000000, 0xf000000000000000, 0x1000000000000000, 0xc000000000000000, 
  0xe000000000000000, 0x8000000000000000, 0x8000000000000000, 0x2000000000000000, 
  0xd000000000000000, 0x4000000000000000, 0x6000000000000000, 0x9000000000000000, 
  0x2000000000000000, 0x1000000000000000, 0xb000000000000000, 0x7000000000000000, 
  0xf000000000000000, 0x5000000000000000, 0xc000000000000000, 0xb000000000000000, 
  0x9000000000000000, 0x3000000000000000, 0x7000000000000000, 0xe000000000000000, 
  0x3000000000000000, 0xa000000000000000, 0xa000000000000000, 0x0, 
  0x5000000000000000, 0x6000000000000000, 0x0, 0xd000000000000000
}, {
  0xf00000000000000, 0x300000000000000, 0x100000000000000, 0xd00000000000000, 
  0x800000000000000, 0x400000000000000, 0xe00000000000000, 0x700000000000000, 
  0x600000000000000, 0xf00000000000000, 0xb00000000000000, 0x200000000000000, 
  0x300000000000000, 0x800000000000000, 0x400000000000000, 0xe00000000000000, 
  0x900000000000000, 0xc00000000000000, 0x700000000000000, 0x0, 
  0x200000000000000, 0x100000000000000, 0xd00000000000000, 0xa00000000000000, 
  0xc00000000000000, 0x600000000000000, 0x0, 0x900000000000000, 
  0x500000000000000, 0xb00000000000000, 0xa00000000000000, 0x500000000000000, 
  0x0, 0xd00000000000000, 0xe00000000000000, 0x800000000000000, 
  0x700000000000000, 0xa00000000000000, 0xb00000000000000, 0x100000000000000, 
  0xa00000000000000, 0x300000000000000, 0x400000000000000, 0xf00000000000000, 
  0xd00000000000000, 0x400000000000000, 0x100000000000000, 0x200000000000000, 
  0x500000000000000, 0xb00000000000000, 0x800000000000000, 0x600000000000000, 
  0xc00000000000000, 0x700000000000000, 0x600000000000000, 0xc00000000000000, 
  0x900000000000000, 0x0, 0x300000000000000, 0x500000000000000, 
  0x200000000000000, 0xe00000000000000, 0xf00000000000000, 0x900000000000000
}, {
  0xa0000000000000, 0xd0000000000000, 0x0, 0x70000000000000, 
  0x90000000000000, 0x0, 0xe0000000000000, 0x90000000000000, 
  0x60000000000000, 0x30000000000000, 0x30000000000000, 0x40000000000000, 
  0xf0000000000000, 0x60000000000000, 0x50000000000000, 0xa0000000000000, 
  0x10000000000000, 0x20000000000000, 0xd0000000000000, 0x80000000000000, 
  0xc0000000000000, 0x50000000000000, 0x70000000000000, 0xe0000000000000, 
  0xb0000000000000, 0xc0000000000000, 0x40000000000000, 0xb0000000000000, 
  0x20000000000000, 0xf0000000000000, 0x80000000000000, 0x10000000000000, 
  0xd0000000000000, 0x10000000000000, 0x60000000000000, 0xa0000000000000, 
  0x40000000000000, 0xd0000000000000, 0x90000000000000, 0x0, 
  0x80000000000000, 0x60000000000000, 0xf0000000000000, 0x90000000000000, 
  0x30000000000000, 0x80000000000000, 0x0, 0x70000000000000, 
  0xb0000000000000, 0x40000000000000, 0x10000000000000, 0xf0000000000000, 
  0x20000000000000, 0xe0000000000000, 0xc0000000000000, 0x30000000000000, 
  0x50000000000000, 0xb0000000000000, 0xa0000000000000, 0x50000000000000, 
  0xe0000000000000, 0x20000000000000, 0x70000000000000, 0xc0000000000000
}, {
  0x7000000000000, 0xd000000000000, 0xd000000000000, 0x8000000000000, 
  0xe000000000000, 0xb000000000000, 0x3000000000000, 0x5000000000000, 
  0x0, 0x6000000000000, 0x6000000000000, 0xf000000000000, 
  0x9000000000000, 0x0, 0xa000000000000, 0x3000000000000, 
  0x1000000000000, 0x4000000000000, 0x2000000000000, 0x7000000000000, 
  0x8000000000000, 0x2000000000000, 0x5000000000000, 0xc000000000000, 
  0xb000000000000, 0x1000000000000, 0xc000000000000, 0xa000000000000, 
  0x4000000000000, 0xe000000000000, 0xf000000000000, 0x9000000000000, 
  0xa000000000000, 0x3000000000000, 0x6000000000000, 0xf000000000000, 
  0x9000000000000, 0x0, 0x0, 0x6000000000000, 
  0xc000000000000, 0xa000000000000, 0xb000000000000, 0x1000000000000, 
  0x7000000000000, 0xd000000000000, 0xd000000000000, 0x8000000000000, 
  0xf000000000000, 0x9000000000000, 0x1000000000000, 0x4000000000000, 
  0x3000000000000, 0x5000000000000, 0xe000000000000, 0xb000000000000, 
  0x5000000000000, 0xc000000000000, 0x2000000000000, 0x7000000000000, 
  0x8000000000000, 0x2000000000000, 0x4000000000000, 0xe000000000000
}, {
  0x200000000000, 0xe00000000000, 0xc00000000000, 0xb00000000000, 
  0x400000000000, 0x200000000000, 0x100000000000, 0xc00000000000, 
  0x700000000000, 0x400000000000, 0xa00000000000, 0x700000000000, 
  0xb00000000000, 0xd00000000000, 0x600000000000, 0x100000000000, 
  0x800000000000, 0x500000000000, 0x500000000000, 0x0, 
  0x300000000000, 0xf00000000000, 0xf00000000000, 0xa00000000000, 
  0xd00000000000, 0x300000000000, 0x0, 0x900000000000, 
  0xe00000000000, 0x800000000000, 0x900000000000, 0x600000000000, 
  0x400000000000, 0xb00000000000, 0x200000000000, 0x800000000000, 
  0x100000000000, 0xc00000000000, 0xb00000000000, 0x700000000000, 
  0xa00000000000, 0x100000000000, 0xd00000000000, 0xe00000000000, 
  0x700000000000, 0x200000000000, 0x800000000000, 0xd00000000000, 
  0xf00000000000, 0x600000000000, 0x900000000000, 0xf00000000000, 
  0xc00000000000, 0x0, 0x500000000000, 0x900000000000, 
  0x600000000000, 0xa00000000000, 0x300000000000, 0x400000000000, 
  0x0, 0x500000000000, 0xe00000000000, 0x300000000000
}, {
  0xc0000000000, 0xa0000000000, 0x10000000000, 0xf0000000000, 
  0xa0000000000, 0x40000000000, 0xf0000000000, 0x20000000000, 
  0x90000000000, 0x70000000000, 0x20000000000, 0xc0000000000, 
  0x60000000000, 0x90000000000, 0x80000000000, 0x50000000000, 
  0x0, 0x60000000000, 0xd0000000000, 0x10000000000, 
  0x30000000000, 0xd0000000000, 0x40000000000, 0xe0000000000, 
  0xe0000000000, 0x0, 0x70000000000, 0xb0000000000, 
  0x50000000000, 0x30000000000, 0xb0000000000, 0x80000000000, 
  0x90000000000, 0x40000000000, 0xe0000000000, 0x30000000000, 
  0xf0000000000, 0x20000000000, 0x50000000000, 0xc0000000000, 
  0x20000000000, 0x90000000000, 0x80000000000, 0x50000000000, 
  0xc0000000000, 0xf0000000000, 0x30000000000, 0xa0000000000, 
  0x70000000000, 0xb0000000000, 0x0, 0xe0000000000, 
  0x40000000000, 0x10000000000, 0xa0000000000, 0x70000000000, 
  0x10000000000, 0x60000000000, 0xd0000000000, 0x0, 
  0xb0000000000, 0x80000000000, 0x60000000000, 0xd0000000000
}, {
  0x4000000000, 0xd000000000, 0xb000000000, 0x0, 
  0x2000000000, 0xb000000000, 0xe000000000, 0x7000000000, 
  0xf000000000, 0x4000000000, 0x0, 0x9000000000, 
  0x8000000000, 0x1000000000, 0xd000000000, 0xa000000000, 
  0x3000000000, 0xe000000000, 0xc000000000, 0x3000000000, 
  0x9000000000, 0x5000000000, 0x7000000000, 0xc000000000, 
  0x5000000000, 0x2000000000, 0xa000000000, 0xf000000000, 
  0x6000000000, 0x8000000000, 0x1000000000, 0x6000000000, 
  0x1000000000, 0x6000000000, 0x4000000000, 0xb000000000, 
  0xb000000000, 0xd000000000, 0xd000000000, 0x8000000000, 
  0xc000000000, 0x1000000000, 0x3000000000, 0x4000000000, 
  0x7000000000, 0xa000000000, 0xe000000000, 0x7000000000, 
  0xa000000000, 0x9000000000, 0xf000000000, 0x5000000000, 
  0x6000000000, 0x0, 0x8000000000, 0xf000000000, 
  0x0, 0xe000000000, 0x5000000000, 0x2000000000, 
  0x9000000000, 0x3000000000, 0x2000000000, 0xc000000000
}, {
  0xd00000000, 0x100000000, 0x200000000, 0xf00000000, 
  0x800000000, 0xd00000000, 0x400000000, 0x800000000, 
  0x600000000, 0xa00000000, 0xf00000000, 0x300000000, 
  0xb00000000, 0x700000000, 0x100000000, 0x400000000, 
  0xa00000000, 0xc00000000, 0x900000000, 0x500000000, 
  0x300000000, 0x600000000, 0xe00000000, 0xb00000000, 
  0x500000000, 0x0, 0x0, 0xe00000000, 
  0xc00000000, 0x900000000, 0x700000000, 0x200000000, 
  0x700000000, 0x200000000, 0xb00000000, 0x100000000, 
  0x400000000, 0xe00000000, 0x100000000, 0x700000000, 
  0x900000000, 0x400000000, 0xc00000000, 0xa00000000, 
  0xe00000000, 0x800000000, 0x200000000, 0xd00000000, 
  0x0, 0xf00000000, 0x600000000, 0xc00000000, 
  0xa00000000, 0x900000000, 0xd00000000, 0x0, 
  0xf00000000, 0x300000000, 0x300000000, 0x500000000, 
  0x500000000, 0x600000000, 0x800000000, 0xb00000000
} };

const static uint32_t IPR_LEN = 64;

const static uint32_t IPR[IPR_LEN] = {
  39, 7, 47, 15, 55, 23, 63, 31,
  38, 6, 46, 14, 54, 22, 62, 30,
  37, 5, 45, 13, 53, 21, 61, 29,
  36, 4, 44, 12, 52, 20, 60, 28,
  35, 3, 43, 11, 51, 19, 59, 27, 
  34, 2, 42, 10, 50, 18, 58, 26,
  33, 1, 41, 9, 49, 17, 57, 25,
  32, 0, 40, 8, 48, 16, 56, 24
};

const static uint32_t P_LEN = 32;

const static uint32_t P[P_LEN] = {
  15,  6, 19, 20, 28, 11, 27, 16,
  0, 14, 22, 25,  4, 17, 30,  9,
  1,  7, 23, 13, 31, 26,  2,  8,
  18, 12, 29,  5, 21, 10,  3, 24
};

#endif
